Задание решил в синтаксисе PostgreSQL. Для проверки:
1) Создаем тестовую базу данных с любым названием.
2) Для генерации таблиц и данных запускается запрос generation_data.sql из папки PostgreSQL_queries
3) Далее запускаем остальные запросы на выборки и расчеты

AVG_price_by_month_18_25.sql - средние суммы покупок за месяц для пользователей с возрастом от 18 до 25 лет.
max_avg_by_month_user_age_before_35.sql - в каком месяце больше всего тратили пользователи с возрастом > 35 лет.
max_purchases_item_by_current_year.sql - самый популярный товар за отчетный период.
top_3_item_by_all_period.sql - топ-3 товаров и их доли в прибыли за весь период.

Для удобства я приложил так же dump базы уже с данными.